-- Pesquisa tabelas dentro do banco e ordena colunas pela quantidade de registros

SELECT	OBJ.NAME AS TABELA,
		IDX.ROWS AS QTDE_REGISTROS
FROM SYS.SYSOBJECTS AS OBJ
INNER JOIN SYS.SYSINDEXES AS IDX
	ON OBJ.ID = IDX.ID
INNER JOIN SYS.TABLES T
	ON OBJ.ID = T.OBJECT_ID
WHERE  OBJ.TYPE = 'U'
AND IDX.INDID < 2
ORDER BY IDX.ROWS DESC
