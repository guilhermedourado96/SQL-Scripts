ALTER  FUNCTION fnRemoveQualificadorCompleto  (@STRING VARCHAR(MAX),@QUALIFICADOR CHAR(1),@DELIMITADOR CHAR(1))  RETURNS VARCHAR(MAX)  AS  
BEGIN  
	DECLARE @POS_INI SMALLINT , 
			    @POS_FIN SMALLINT

WHILE (SELECT CHARINDEX(@QUALIFICADOR, @STRING))  > 0
	BEGIN
		SELECT @POS_INI = CHARINDEX(@QUALIFICADOR, @STRING)
  	SET @STRING		  = STUFF(@STRING, @POS_INI,1,'')

		SELECT @POS_FIN = CHARINDEX(@QUALIFICADOR, @STRING)
		SET @STRING		  = STUFF(@STRING,@POS_FIN,1,'')

		SET @STRING = CONCAT(SUBSTRING(@STRING,1,@POS_INI-1),REPLACE(SUBSTRING(@STRING,@POS_INI,(@POS_FIN-@POS_INI)),@DELIMITADOR,' '),SUBSTRING(@STRING,@POS_FIN,LEN(@STRING)) )

	END
	RETURN @STRING
END 
